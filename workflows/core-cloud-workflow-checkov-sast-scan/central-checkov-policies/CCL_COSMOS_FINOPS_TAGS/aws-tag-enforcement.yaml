metadata:
  name: "Ensure resources have required tag associated for Costing"
  id: "CCL_COSMOS_FINOPS_TAGS"
  category: "CONVENTION"
  guideline: "All resources must have the mandatory tags as specified here: https://collaboration.homeoffice.gov.uk/display/CORE/Core+Cloud+Tags"
  severity: "HIGH"
definition:
  and:
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.cost-centre"
    operator: "exists"
    # value: "1709144"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.account-code"
    operator: "exists"
    # value: "521835"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.portfolio-id"
    operator: "exists"
    # value: "cto"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.project-id"
    operator: "exists"
    # value: "corecloud"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.service-id"
    operator: "exists"